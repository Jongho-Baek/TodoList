version: '3.8'

services:
  web:
    # Dockerfile을 사용하여 현재 디렉토리에서 이미지를 빌드합니다.
    build: .
    
    # 컨테이너 포트 8000을 호스트 포트 8000으로 연결합니다.
    ports:
      - "8000:8000"
      
    # [수정] 볼륨 정의를 하나로 합치고, 프로젝트 전체를 마운트합니다.
    # 이렇게 하면 db.sqlite3 파일은 호스트 OS의 파일 시스템에 저장됩니다.
    volumes:
      - .:/usr/src/app 
      
    # Django 애플리케이션의 실행 명령어
    command: >
      sh -c "python manage.py collectstatic --noinput &&
             python manage.py migrate &&
             python manage.py runserver 0.0.0.0:8000"
    
    # 환경 변수 (필요한 경우 여기에 추가합니다.)
    environment:
      - DEBUG=True # 현재 개발 환경을 위해 True로 유지 권장
      
# [제거] Docker 관리 볼륨 정의를 제거합니다.
# volumes:
#   db_data:
